link --------------  https://www.codingninjas.com/codestudio/problems/capital-gainloss_2122059?topList=top-100-sql-problems


----------------------- solution ------------------------------


select stock_name,sum(case when operation='Buy' then -price else price end) as capital_gain_loss from stocks group by stock_name




